#include "RungeKutta.nsh"
#include "Fixed.nsh"
#include "Function.nsh"

module RungeKutta {
  Fixed alu1, alu2, alu3, alu4, alu5, alu6, alu7, alu8, alu9, alu10, alu11, alu12, alu13;
  Function derivation1, derivation2, derivation3, derivation4;
  wire k1[32], k2[32], k3[32], k4[32];
  wire k2_arg[32], k3_arg[32], k4_arg[32];
  wire res1[32], res2[32], res3[32], res4[32];
  wire res_rk[32];

  func exec{
    k1 = alu1.mul(32'h00000100, derivation1.exec(previous));

    res_rk = previous + k1;

    return res_rk;
  }
}
